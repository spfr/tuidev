# ============================================================================
# SSH Server Hardening for Tailscale
# ============================================================================
# REFERENCE ONLY - Not auto-deployed by install.sh
#
# To use, manually copy to your sshd_config.d directory:
#   sudo cp this-file /etc/ssh/sshd_config.d/tailscale.conf
#   sudo launchctl stop com.openssh.sshd
#   sudo launchctl start com.openssh.sshd
#
# This config hardens SSH when accessed primarily via Tailscale.
# ============================================================================

# Disable password authentication (use SSH keys only)
PasswordAuthentication no
KbdInteractiveAuthentication no

# Enable public key authentication
PubkeyAuthentication yes

# Limit authentication attempts
MaxAuthTries 3
MaxSessions 5

# Disable root login
PermitRootLogin no

# Use modern key exchange algorithms
KexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org

# Use modern ciphers
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com

# Use modern MACs
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com

# Disable unused authentication methods
ChallengeResponseAuthentication no
UsePAM no

# Logging
LogLevel VERBOSE
